{% extends 'base.html' %}
{% block body %}


<style>
    .ur {
        font-family: Nafees Nastaleeq;
        font-style: normal;
        font-weight: normal;
        line-height: 2.2;
        white-space: pre-wrap;
        font-size: 20px;
    }

    .listening {
        background-color: brown;
        border: 1px solid brown;
        color: #fff;
    }

    #output p {
        padding: 10px;
        border: 1px solid #aaaaaa60;
        border-radius: 10px;
    }
</style>

<title>GetUserMedia demo</title>

<div class="container">
    <div class="h-100 p-5 text-bg-dark rounded-3">
        <h2>Speech to text APP</h2>
        <p>Real-time transcription playground using the Web Speech.</p>
        <button class="btn btn-outline-light" type="button" id="speechStart">Speech</button>
        <div id="output" class="mt-5"></div>
    </div>
</div>

<script>
    const outputWrapper = document.querySelector('#output');

    async function fetchAPI() {
        let url = '/api/files/';
        let res = await fetch(url);
        let data = await res.json();
        return data.results;
    };

    async function wishperAction() {
        const transcribeData = await fetchAPI()
        transcribeData.forEach((item) => {
            outputWrapper.innerHTML += `
                <p class="ur">${item.transcript}</p>`;
        });
    };
    wishperAction();
</script>


<!-- <script>
    const speechButton = document.getElementById("speechStart");
    const outputElement = document.getElementById("output");
    const recognition = new window.webkitSpeechRecognition();

    recognition.continuous = true;
    recognition.interimResults = true;
    recognition.lang = 'en-US';

    speechButton.addEventListener("mousedown", function () {
        this.classList.add("btn-outline-danger");
        this.classList.remove("btn-outline-light");
        this.textContent = 'Stop'
        // recognition.start();
    });

    speechButton.addEventListener("mouseup", () => {
        speechButton.classList.remove("btn-outline-danger");
        speechButton.classList.add("btn-outline-light");
        speechButton.textContent = 'Speech'

        // recognition.stop();
    });

    recognition.addEventListener("result", function (event) {
        const result = event.results[event.results.length - 1][0].transcript;
        outputElement.textContent = result;
    });



    // fetch('/transcription/', {
    //     method: 'POST',
    //     body: JSON.stringify({ transcript }),
    //     headers: {
    //         'Content-Type': 'application/json',
    //         'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
    //     },
    // });


</script> -->


{% endblock %}